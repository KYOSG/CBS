<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-/mybatis.org/DTD Mapper 3.0/EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >

<mapper namespace="com.ky.ClassBrrowSystem.dao.RoomBorrowedInfoDAO">

    <resultMap id="roomInfoMap" type="RoomBorrowedInfo">
        <id column="logId" property="logId"/>
        <result column="borrow_room_id" property="borrowRoomId"/>
        <result column="borrow_user_id" property="borrowUserId"/>
        <result column="borrow_time_id" property="borrowTimeId"/>
        <result column="borrow_date" property="borrowDate"/>
        <result column="borrow_reason" property="borrowReason"/>
        <result column="apply_time" property="applyTime"/>
        <result column="isNeedMedia" property="isNeedMedia"/>
        <result column="isAdmit" property="isAdmit"/>
    </resultMap>

    <!--Query-->
    <select id="queryRBIByOptions" resultMap="roomInfoMap">
        select borrow_room_id,borrow_room_name,borrow_date,borrow_time_id,borrow_reason,borrow_time_name,username,user_id,apply_time
        from RBS.borrowInfo,RBS.users
        <where>
            <if test="borrow_date != null">borrow_date = #{arg0}</if>
            <if test="borrow_time_id != 0">borrow_time_id = #{arg1}</if>
            <if test="borrow_reason != null">borrow_reason = #{arg2}</if>
            <if test="borrow_room_id != null">borrow_room_id = #{arg3}</if>
            <if test="user_id != null">user_id = #{arg4}</if>
        </where>
    </select>

    <select id="queryRBIByUserId" resultMap="roomInfoMap">
        select *
        from RBS.borrowInfo
        where borrow_user = #{userId}
    </select>

    <select id="queryRBIByTime" resultMap="roomInfoMap">
        select *
        from RBS.borrowInfo
        where borrow_date = #{arg0} and borrow_time_id = #{arg1}
    </select>

    <select id="queryRBIByTimeAndRoomId" resultMap="roomInfoMap">
        select *
        from RBS.borrowInfo
        where borrow_time_id = #{arg0} and borrow_date = #{arg1} and borrow_room_id = #{arg2}
    </select>
<!--    查询某教室某时间之后的借用信息-->




    <!--Operator-->
    <select id="borrow" resultMap="roomInfoMap">
        insert into RBS.borrowInfo (borrow_date, borrow_time_id, borrow_time_name, borrow_room_id, borrow_room_name, borrow_user,borrow_reason, apply_time,isNeedMedia,isAdmit)
        values (#{arg0},#{arg1},#{arg2},#{arg3},#{arg4},#{arg5},#{arg6},#{arg7},1,1)
    </select>

    <select id="cancel" resultMap="roomInfoMap">

    </select>



</mapper>